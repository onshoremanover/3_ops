controllers:
  main:
    containers:
      main:
        image:
          tag: v2.0.1

immich:
  metrics:
    enabled: false
  persistence:
    library:
      existingClaim: immich-library-pvc 

server:
  enabled: true
  controllers:
    main:
      containers:
        main:
          image:
            repository: ghcr.io/immich-app/immich-server
            # tag inherited from controllers.main.containers.main.image.tag (v2.0.1)
          env:
            DB_URL: postgresql://immich:immichpassword@immich-postgresql:5432/immich
            REDIS_HOSTNAME: immich-valkey
            IMMICH_MACHINE_LEARNING_URL: http://immich-machine-learning:3003
  ingress:
    main:
      enabled: false
  # (resources are fine to keep if you like; omitted here for brevity)

valkey:
  enabled: false   # you already run immich-valkey

machine-learning:
  enabled: true
  controllers:
    main:
      containers:
        main:
          image:
            repository: ghcr.io/immich-app/immich-machine-learning
            pullPolicy: IfNotPresent
          env:
            TRANSFORMERS_CACHE: /cache
  persistence:
    cache:
      enabled: true
      type: emptyDir
      size: 10Gi

